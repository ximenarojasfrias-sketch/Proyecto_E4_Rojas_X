---
title: ‚ÄúDistribuci√≥n y condiciones clim√°ticas asociadas a los registros de la especie
  Phoca vitulina y la subespecie Phoca vitulina richardii en Norte Am√©rica‚Äù
author: "Equipo 4"
date: "2025-10-27"
output:
  html_document:
    toc: true
    toc_float: true
    toc_depth: 3
    number_sections: true
    theme: cosmo
    highlight: tango
  pdf_document:
    toc: true
    toc_depth: '3'
---

```{css, echo=FALSE}
/* Justificaci√≥n del texto */
body {
  text-align: justify;
  text-justify: inter-word;
}

p, li {
  text-align: justify;
  text-justify: inter-word;
  line-height: 1.6;
}

h1, h2, h3, h4, h5, h6 {
  text-align: left;
}

.figure {
  text-align: center;
}

.fig-caption {
  text-align: center;
  font-style: italic;
  color: #666;
}
```

![](images/clipboard-1168385233.png){width="457"}

::: {style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 25px; border-radius: 10px; box-shadow: 0 4px 6px rgba(0,0,0,0.1);"}
**üß™ Proyecto Acad√©mico**

**üë®‚Äçüè´ Profesores responsables:**\
Pingarroni Mart√≠n del Campo Aline\
Auliz Ortiz Daniel Mart√≠n

**üë• Integrantes del Equipo 4:**\
Alvarado Mota Jonatan Mart√≠n\
Rojas Fr√≠as Ximena\
Velazquez Rivera Gael Jesus

**üìö Licenciatura en Ecolog√≠a**\
**üèõÔ∏è Facultad de Estudios Superiores Iztacala**\
**üìÖ 28 de octubre de 2025**
:::

------------------------------------------------------------------------

# **Introducci√≥n**

La distribuci√≥n espacial de los mam√≠feros marinos es un componente clave para comprender su ecolog√≠a, comportamiento y vulnerabilidad ante el cambio ambiental. En particular, *Phoca vitulina* y su subespecie *Phoca vitulina richardii* presentan patrones de ocurrencia estrechamente ligados a zonas costeras de baja altitud, lo que las convierte en bioindicadores sensibles de la salud de los ecosistemas marinos (Morales, 2014). Estudiar su presencia en distintas regiones de Am√©rica del Norte permite identificar √°reas cr√≠ticas de conservaci√≥n, evaluar desplazamientos poblacionales y anticipar respuestas ecol√≥gicas ante presiones antropog√©nicas. (Nuche, 2012).\
\
El cambio clim√°tico representa una amenaza creciente para los mam√≠feros marinos, incluyendo *Phoca vitulina*, cuyas poblaciones dependen de condiciones costeras estables y accesibles. El incremento de la temperatura del oc√©ano, la reducci√≥n de hielo marino y las alteraciones en la disponibilidad de presas est√°n modificando sus patrones de distribuci√≥n, reproducci√≥n y comportamiento migratorio (D√≠az Cordero, 2012). Estos factores pueden provocar desplazamientos hacia nuevas √°reas, aumentar la competencia inter-espec√≠fica y reducir la viabilidad de ciertas poblaciones, especialmente en los l√≠mites de su rango geogr√°fico. Comprender estas din√°micas es esencial para anticipar escenarios ecol√≥gicos futuros y dise√±ar estrategias de conservaci√≥n adaptativas.

[![]()](https://inaturalist-open-data.s3.amazonaws.com/photos/318367039/large.jpg)

![](images/clipboard-2522779906.png)

En este contexto, el lenguaje de programaci√≥n R se ha consolidado como una herramienta poderosa para el an√°lisis de datos ecol√≥gicos, permitiendo la visualizaci√≥n geoespacial, la generaci√≥n de gr√°ficos din√°micos y la integraci√≥n de fuentes como GBIF y WorldClim. Su aplicaci√≥n agiliza el manejo de grandes conjuntos de datos y fomenta la transparencia metodol√≥gica, aspectos esenciales en la investigaci√≥n de la biodiversidad (Beckerman et al., 2017)

La creciente disponibilidad de datos abiertos sobre biodiversidad exige m√©todos anal√≠ticos robustos y accesibles que permitan extraer patrones ecol√≥gicos significativos. El estudio de la distribuci√≥n de *Phoca vitulina* en Canad√°, Estados Unidos y M√©xico no solo aporta informaci√≥n sobre sus preferencias de h√°bitat, sino que tambi√©n permite evaluar los l√≠mites ecol√≥gicos de la especie y detectar posibles cambios en su rango geogr√°fico (Nuche, 2012). Utilizar R para procesar y visualizar estos datos garantiza un enfoque reproducible, transparente y adaptable a distintos contextos de investigaci√≥n y conservaci√≥n (Morales, 2014; Beckerman et al., 2017).¬†

Por lo tanto, el presente trabajo tiene como objetivo examinar la distribuci√≥n geogr√°fica y altitudinal de *Phoca vitulina* y la subespecie *P. v*. *richardii* en Am√©rica del Norte entre 2007 y 2024, utilizando herramientas de visualizaci√≥n y an√°lisis espacial en R, evaluando su relaci√≥n con variables clim√°ticas clave con el fin de identificar patrones ecol√≥gicos relevantes y contribuir al dise√±o de estrategias de conservaci√≥n basadas en evidencia.

## **Pregunta de investigaci√≥n**

¬øExisten diferencias en las condiciones bioclim√°ticas de los sitios donde se registran Phoca vitulina y Phoca vitulina richardii en Norte Am√©rica?

## **Variables a considerar**

**GBIF:**

-   Sitios de ocurrencia de *P. vitulina* y *P.v. richardii* en Norte Am√©rica (MX, CA, US)

Una ocurrencia es la evidencia de que una especie (u otro tax√≥n) estaba en un lugar espec√≠fico en una fecha espec√≠fica

**WorldClim**:

-   [Bio_01:]{.underline} Temperatura media anual

-   [Bio_04:]{.underline} Estacionalidad de la temperatura (desviaci√≥n est√°ndar √ó100)

-   [Bio_12:]{.underline} Precipitaci√≥n anual

-   [Bio_15:]{.underline} ¬†Estacionalidad de la precipitaci√≥n (coeficiente de variaci√≥n)

------------------------------------------------------------------------

# **Bases de datos**

Para la realizaci√≥n de este proyecto se utilizaron dos fuentes principales:

-   ***GBIF (Global Biodiversity Information Facility)\
    ***Plataforma internacional de acceso abierto que concentra registros de presencia de especies a partir de museos, monitoreos e instituciones cient√≠ficas. Esta permite facilitar el acceso a datos georreferenciados de biodiversidad a escala global. Los datos a emplear fueron: registros con coordenadas geogr√°ficas de Phoca vitulina y Phoca vitulina richardii en M√©xico, Canad√° y Estados Unidos

    -   Variables relevantes:

        -   decimalLatitude, decimalLongitude (coordenadas geogr√°ficas)

        -   eventDate (fecha de observaci√≥n)

        -   species (especie)

        -   scientificName (nombre cient√≠fico completo)

        -   basisOfRecord, institutionCode (fuente del registro)

            Enlace: <https://www.gbif.org/>\

-   ***WorldClim versi√≥n 2.1*****\
    **Base de datos mundial de variables clim√°ticas derivadas de promedios de temperatura y precipitaci√≥n (1970‚Äì2000). Es util pues una de sus funciones es proveer capas raster de variables bioclim√°ticas para modelar distribuciones de especies.

    -   Variables relevantes:

        -   bio1 = temperatura media anual

        -   bio12 = precipitaci√≥n anual

        -   bio4 = estacionalidad de la temperatura

        -   bio15 = estacionalidad de la precipitaci√≥n\
            Enlace: <https://www.worldclim.org/data/worldclim21.html>

Ambas bases se integrar√°n en R mediante los paquetes rgbif y terra, extrayendo las variables clim√°ticas correspondientes a cada punto de presencia.

## **Exploraci√≥n y transformaci√≥n de bases de datos**

**PASO 1: Librerias**

```{r librerias, message=FALSE, warning=FALSE}
#Paquetes a utilizar
library(rgbif) #descargar datos de ocurrencias
library(tidyverse) #procesamiento de datos
library(sf) #manipulaci√≥n  de datos vectoriales
library(rworldxtra) #datos vectoriales de los paises del mundo
library(geodata) #datos geoespaciales complemenatarios
library(ggspatial)#auxiliar para visualizar datos espaciales
library(terra) #datos raster
library(tidyterra) #maniipulaci√≥n de raster
library(paletteer) #colores
library(ggcorrplot) #diagrama de correlaciones
library(ggridges) #gr√°fico de ridges
library(plotly) #gr√°ficos avanzados
library(patchwork) #organizar gr√°ficos
library(magick) #para manejo de imagenes
library(grid) #organizar y escribir m√∫ltiples grobs en un dispositivo gr√°fico e incluir tablas en objetos gr√°ficos de cuadr√≠cula
library(cowplot) #funciones que facilitan la anotaci√≥n de gr√°ficos o su combinaci√≥n con im√°genes
library(rlang) #proporciona varias interfaces para trabajar con R y objetos R
```

**PASO 2: Extraer datos de focas de cada pa√≠s de Norte Am√©rica de GBIF**

```{r message=FALSE, warning=FALSE}
#Vitulina MX
foca1mx <- occ_search(scientificName = "Phoca vitulina Linnaeus", 
                      hasCoordinate = TRUE, 
                      hasGeospatialIssue = FALSE,
                      country = "MX"
)$data

foca1mx <- foca1mx %>% 
  filter(scientificName == "Phoca vitulina Linnaeus, 1758") #eliminar subespecie

#richardii MX
foca2mx <- occ_search(scientificName = "Phoca vitulina richardii", 
                      hasCoordinate = TRUE, 
                      hasGeospatialIssue = FALSE,
                      country = "MX"
)$data
##verificar que los datos sean unicamente de mx
unique(foca1mx$countryCode)
unique(foca2mx$countryCode)

#Vitulina CA
foca1ca <- occ_search(scientificName = "Phoca vitulina Linnaeus ", 
                      hasCoordinate = TRUE, 
                      hasGeospatialIssue = FALSE,
                      country = "CA"
)$data
foca1ca <- foca1ca %>% 
  filter(scientificName == "Phoca vitulina Linnaeus, 1758") #eliminar subespecie

#richardii CA
foca2ca <- occ_search(scientificName = "Phoca vitulina richardii", 
                      hasCoordinate = TRUE, 
                      hasGeospatialIssue = FALSE,
                      country = "CA"
)$data

###verificar que los datos sean unicamente de ca
unique(foca1ca$countryCode)
unique(foca2ca$countryCode)

#Vitulina US
foca1us <- occ_search(scientificName = "Phoca vitulina Linnaeus ", 
                      hasCoordinate = TRUE, 
                      hasGeospatialIssue = FALSE,
                      country = "US"
)$data
foca1us <- foca1us %>% 
  filter(scientificName == "Phoca vitulina Linnaeus, 1758")
#richardii US
foca2us <- occ_search(scientificName = "Phoca vitulina richardii", 
                      hasCoordinate = TRUE, 
                      hasGeospatialIssue = FALSE,
                      country = "US"
)$data

###verificar que los datos sean unicamente de us
unique(foca1us$countryCode)
unique(foca2us$countryCode)
```

-   **A√±adir columna para indicar pa√≠s en cada base**

```{r message=FALSE, warning=FALSE}
foca1mx <- foca1mx %>% mutate(country = "Mexico", species = "Phoca vitulina Linnaeus")
foca1ca <- foca1ca %>% mutate(country = "Canada", species = "Phoca vitulina Linnaeus")
foca1us <- foca1us %>% mutate(country = "USA", species = "Phoca vitulina Linnaeus")

foca2mx <- foca2mx %>% mutate(country = "Mexico", species = "Phoca vitulina")
foca2ca <- foca2ca %>% mutate(country = "Canada", species = "Phoca vitulina")
foca2us <- foca2us %>% mutate(country = "USA", species = "Phoca vitulina")
```

-   **Unir bases de cada pa√≠s por foca (P. vitulina y P. v. richardii**

```{r message=FALSE, warning=FALSE}
foca1_NorteA <- bind_rows(foca1mx, foca1ca, foca1us)
foca2_NorteA <- bind_rows(foca2mx, foca2ca, foca2us)
```

-   **A√±adir columna con spp y subespecie**

```{r message=FALSE, warning=FALSE}
foca1_NorteA <- foca1_NorteA %>% mutate(species = "Phoca vitulina ")
foca2_NorteA <- foca2_NorteA %>% mutate(species = "Phoca vitulina richardii")

```

**PASO 3: Filtrar bases de datos de focas**

-   **Por tipo de registro:**

    ```{r}
    ##para phoca vitulina
    unique(foca1_NorteA$basisOfRecord)
    foca1_NorteA %>% 
      ggplot(aes(x= basisOfRecord, fill= basisOfRecord))+
      geom_bar()+
      coord_flip()+
      theme(legend.position = "none") 
    foca1_NorteA <- foca1_NorteA %>% 
      filter(basisOfRecord %in% c(c("HUMAN_OBSERVATION", "PRESERVED_SPECIMEN"))) #dejar unicamente observaciones humanas y especimenes preservados

    ##para phoca vitulina richardii
    unique(foca2_NorteA$basisOfRecord)
    foca2_NorteA %>% 
      ggplot(aes(x= basisOfRecord, fill= basisOfRecord))+
      geom_bar()+
      coord_flip()+
      theme(legend.position = "none") 
    foca2_NorteA <- foca2_NorteA %>% 
      filter(basisOfRecord %in% c(c("HUMAN_OBSERVATION", "PRESERVED_SPECIMEN"))) #dejar unicamente observaciones humanas y especimenes preservados
    ```

-   **Por instituci√≥n de registro**

    ```{r}
    ##para phoca vitulina richardii
    unique(foca1_NorteA$institutionCode)

    foca1_NorteA %>% 
      ggplot(aes(x= institutionCode, fill= institutionCode))+
      geom_bar()+
      coord_flip()+
      theme(legend.position = "none") 
    #remover na
    foca1_NorteA <- foca1_NorteA %>% 
      filter(!is.na(institutionCode))

    ##para phoca vitulina richardii
    unique(foca2_NorteA$institutionCode)
    foca2_NorteA %>% 
      ggplot(aes(x= institutionCode, fill= institutionCode))+
      geom_bar()+
      coord_flip()+
      theme(legend.position = "none") 

    #como no hay ning√∫n na no se eliminaron
    ```

**PASO 4: Transformar bases para usar en los mapas**

-   **Archivos SF de ocurrencias de focas**

    ```{r}
    foca1_NorteA_sf <- foca1_NorteA %>% 
      st_as_sf(coords = c("decimalLongitude", "decimalLatitude"), crs= 4326)

    foca2_NorteA_sf <- foca2_NorteA %>% 
      st_as_sf(coords = c("decimalLongitude", "decimalLatitude"), crs= 4326)
    ```

-   **Capa Raster y archivos vectoriales**

    ```{r}
    alt <- worldclim_global(var="elev", res=5, path=tempdir())
    data(countriesHigh) 
    Mundo <- st_as_sf(countriesHigh) 
    ```

**PASO 5: Extracci√≥n de bases de datos ambientales**

```{r}
env <- worldclim_global(var = "bio", res = 10, path = "datos_wc")
names(env)

#simplificar nombre de las variables
v_names <- vector()
for(i in 1:19){
  
  v_names[i] <- paste0("bio_", sprintf("%02d", i)) 
}

v_names

names(env) <- v_names

env
```

-   **Extraer datos en los puntos de ocurrencia de cada especie**

```{r message=FALSE, warning=FALSE}
foca1_NorteA_env <- extract(env, foca1_NorteA_sf)

foca1_NorteA_env$species <- c("Phoca vitulina")

foca2_NorteA_env <- extract(env, foca2_NorteA_sf)

foca2_NorteA_env$species <- c("Phoca vitulina richardii")
```

```{r message=FALSE, warning=FALSE}
## unir ambas bases
df_env <- bind_rows(foca1_NorteA_env, foca2_NorteA_env)
```

**PASO 6: Transformaci√≥n de bases de datos para gr√°ficos de exploraci√≥n**

-   **Limpiar bases de datos para seleccionar variables deseadas para gr√°fico de numero de registros:**

    ```{r message=FALSE, warning=FALSE}
    #Seleccionar variables
    names(foca1_NorteA)
    foca1_abundancias <- foca1_NorteA %>%
      select(species, country, individualCount) %>%
      mutate(
        species = "Phoca vitulina",
        individualCount = ifelse(is.na(individualCount), 1, individualCount) #para poner cada observaci√≥n 1 por 1
      )
    unique(foca1_abundancias$country)

    foca2_abundancias <- foca2_NorteA %>%
      select(species, country, individualCount) %>%
      mutate(
        species = "Phoca vitulina richardii",
        individualCount = ifelse(is.na(individualCount), 1, individualCount) #para poner cada observaci√≥n 1 por 1
      )

    #Unificar ambas especies
    focas_abundancias <- bind_rows(foca1_abundancias,foca2_abundancias)

    #Confirmaci√≥n de que se encuentran los datos necesarios de cada variable
    names(focas_abundancias)
    unique(focas_abundancias$species)
    unique(focas_abundancias$country)

    #Resumen de observaciones por pa√≠s
    focas_resumen <- focas_abundancias %>%
      group_by(country, species) %>%
      summarise(n_obs = sum(individualCount, na.rm = TRUE)) %>%
      ungroup()

    ```

-   **Transformar bases de datos para gr√°fico boxplot**

    ```{r message=FALSE, warning=FALSE}
    # Preparar datos en formato largo
    box_df <- df_env %>%
      select(
        species,
        bio_01, # temp media anual
        bio_04, # estacionalidad temp
        bio_12, # precipitaci√≥n anual
        bio_15  # estacionalidad precip
      ) %>%
      pivot_longer(
        cols = c(bio_01, bio_04, bio_12, bio_15),
        names_to = "variable",
        values_to = "valor"
      )

    # Etiquetas para facet
    etiquetas_vars <- c(
      "bio_01" = "Temp. media anual (BIO1)",
      "bio_04" = "Estacionalidad temp (BIO4)",
      "bio_12" = "Precipitaci√≥n anual (BIO12)",
      "bio_15" = "Estacionalidad precipitaci√≥n (BIO15)"
    )

    #A√±adir etiquetas al df
    box_df$variable <- factor(
      box_df$variable,
      levels = names(etiquetas_vars),
      labels = etiquetas_vars
    )

    # Ordenar especies para que salgan siempre en el mismo orden visual
    box_df$species <- factor(
      box_df$species,
      levels = c("Phoca vitulina", "Phoca vitulina richardii")
    )
    ```

# **Mapas**

A continuaci√≥n se presentan los mapas del sitio de estudio y la distribuci√≥n de las especies seleccionadas

## **Mapa de sitio de estudio**

```{r message=FALSE, warning=FALSE}
mapa_NA_occ <- ggplot() +
  # Capa base: altitud
  geom_spatraster(data = alt, alpha = 0.8) +
  
  # Borde de pa√≠ses
  geom_sf(data = Mundo, fill = NA, color = "gray40", linewidth = 0.2) +
  
  # Capas vectoriales de focas
  geom_sf(data = foca1_NorteA_sf, aes(color = species), size = 2, alpha = 0.5) +
  geom_sf(data = foca2_NorteA_sf, aes(color = species), size = 2, alpha = 0.5) +
  
  # Zoom a Norte Am√©rica
  coord_sf(xlim = c(-135, -55), ylim = c(27, 60)) +
  
  # Escala de altitud con paleta viridis 
  scale_fill_paletteer_c(
    "viridis::viridis",
    direction = -1,
    limits = c(0, 5000),
    na.value = "transparent",
    name = "Altitud (m s.n.m.)"
  ) +
  
  # Colores de especies
  scale_color_manual(
    values = c("#002F70","#742324"),
    
    name = "Especies"
  ) +
  # Etiquetas
  labs(
    title = "Distribuci√≥n de Phoca vitulina y P. v. richardii en Am√©rica del Norte",
    subtitle = "Registros de ocurrencia (GBIF, 2007‚Äì2024)",
    caption = "Elaborado por Equipo 4  |  Datos: GBIF & WorldClim v2.1"
  ) +
  
  #Rosa de los vientos
  annotation_north_arrow(
    location = "bl", which_north = "true",
    pad_x = unit(0.4, "in"), pad_y = unit(0.9, "in"),
    style = north_arrow_nautical(fill = c("white", "gray60"))
  ) +
  #Escala del mapa
  annotation_scale(
    location = "bl", bar_cols = c("gray60", "white"), text_family = "lato"
  ) +
  # Theme 
  theme_minimal(base_family = "lato") +
  theme(
    plot.title = element_text(size = 18, face = "bold", hjust = 0.5),
    plot.subtitle = element_text(size = 13, hjust = 0.5, color = "gray30"),
    plot.caption = element_text(size = 9, color = "gray40", hjust = 0.5),
    legend.position.inside = c(0.86, 0.25),
    legend.background = element_rect(fill = alpha("white", 0.8), color = "gray80"),
    legend.key = element_rect(fill = "transparent"),
    axis.text = element_text(size = 10),
    panel.grid = element_blank()
  )

print(mapa_NA_occ)
```

## **Mapas a diferentes escalas: Pa√≠ses del sitio de estudio**

**PASO 1:** **Crear funci√≥n. Al introducir las coordenadas correspondientes a cada pa√≠s (xmin,xmax,ymin,ymax) titulo y el nombre del archivo png de la bandera de cada pa√≠s incluidos en la carpeta del proyecto (bandera_path) se crea el mapa a escala de cada pa√≠s de norte am√©rica**

```{r message=FALSE, warning=FALSE}
crear_mapa_pais <- function(xmin, xmax, ymin, ymax, titulo, bandera_path) {
  
  mapa <- ggplot() +
    # Capa de relieve
    geom_spatraster(data = alt, alpha = 0.7) +
    
    # Borde de pa√≠ses
    geom_sf(data = Mundo, fill = NA, color = "gray40", linewidth = 0.3) +
    
    # Capas vectoriales de ocurrencias de focas
    geom_sf(data = foca1_NorteA_sf, aes(color = species), size = 2, alpha = 0.9) +
    geom_sf(data = foca2_NorteA_sf, aes(color = species), size = 2, alpha = 0.9) +
    
    # Coordenadas del pa√≠s para hacer zoom
    coord_sf(xlim = c(xmin, xmax), ylim = c(ymin, ymax)) +
    
    # Escala de altitud con paleta viridis y colores de cada especie
    scale_fill_paletteer_c("viridis::viridis", direction = -1, limits = c(0, 5000),
                           na.value = "transparent", name = "Altitud (m s.n.m.)") +
    scale_color_manual(values = c("#002F70","#742324"),
      name = "Especies") +
    
    # Escala del mapa y rosa de los vientos
    annotation_scale(location = "bl", bar_cols = c("gray60", "white"), text_family = "lato") +
    annotation_north_arrow(location = "bl", which_north = "true",
                           pad_x = unit(0.4, "in"), pad_y = unit(0.9, "in"),
                           style = north_arrow_nautical(fill = c("white", "gray60"))) +
    
    # Etiquetas
    labs(
      title = titulo,
      subtitle = "Registros de ocurrencia (GBIF, 2007‚Äì2024)",
      caption = "Elaborado por Equipo 4  |  Datos: GBIF & WorldClim v2.1"
    ) +
    
    theme_minimal() 
    
  # Agregar bandera
  bandera <- image_read(bandera_path)
  mapa_final <- ggdraw() +
    draw_plot(mapa) +
    draw_image(bandera, x = 0.82, y = 0.03, width = 0.16, height = 0.16)
  
  return(mapa_final)
}
```

**PASO 2:** **Crear mapa de cada pa√≠s introduciendo los datos correspondientes**

-   **Mapa MX**

    ```{r message=FALSE, warning=FALSE}
    mapa_mx <- crear_mapa_pais(
      xmin = -120, xmax = -105, ymin = 22, ymax = 33,
      titulo = "Distribuci√≥n de P. vitulina y P.v. richardii en M√©xico",
      bandera_path = "Bandera_mx.png"
    )
    print(mapa_mx)
    ## guardar mapa mx
    ggsave("mapa_mx.png", 
           mapa_mx, width = 10, height = 8, units = "in",
           bg="white",
           dpi = 300)
    ```

-   **Mapa US**

    ```{r message=FALSE, warning=FALSE}
    mapa_us <- crear_mapa_pais(
      xmin = -125, xmax = -65, ymin = 25, ymax = 50,
      titulo = "Distribuci√≥n de P. vitulina y P.v. richardii en Estados Unidos",
      bandera_path = "Bandera_usa.png"
    )
    print(mapa_us)
    ## guardar mapa us 
    ggsave("mapa_us.png", 
           mapa_us, width = 10, height = 8, units = "in",
           bg="white",
           dpi = 300)
    ```

-   **Mapa CA**

    ```{r message=FALSE, warning=FALSE}
    mapa_ca <- crear_mapa_pais(
      xmin = -140, xmax = -50, ymin = 45, ymax = 70,
      titulo = "Distribuci√≥n de P. vitulina y P.v. richardii en Canad√°",
      bandera_path = "Bandera_ca.png"
    )
    print(mapa_ca)
    ## guardar mapa ca
    ggsave("mapa_ca.png", 
           mapa_ca, width = 10, height = 8, units = "in",
           bg="white",
           dpi = 300)
    ```

# **Gr√°ficos de exploraci√≥n**

Para explorar ambas bases de datos, se realizaron dos gr√°ficos que permitieron visualizar las variables que ocupamos para el estudio. El primero fue un geom_bar con el n√∫mero de registros de Phoca vitulina y Phoca vitulina richardii en los 3 pa√≠ses de Norte Am√©rica, y fue util para conocer en cual de estos fueron m√°s abundantes. El segundo gr√°fico fue un boxplot sobre las variables clim√°ticas en los sitios de avistamiento de ambas focas, y permitieron observar el contraste de nichos.

## **Grafico de exploraci√≥n 1:**

```{r message=FALSE, warning=FALSE}
#grafico usando la base de datos foca_resumen
g_abundancias_pais <- ggplot(focas_resumen, 
                             aes(x = reorder(country, -n_obs),
                                 y = n_obs, 
                                 fill = species)) +
  #el tipo de grafico es barrras
  geom_col(position = "dodge", color = "white", width = 0.7) +
  
  #a√±ade etiquetas de valores (n_observaciones)
  geom_text(aes(label = n_obs),
            position = position_dodge(width = 0.7),
            vjust = -0.5, size = 3.5, color = "gray15") +
  
  #escala de colores por especie 
  scale_fill_manual(
    values = c("#CF7940", "#5F7759"),
    labels = c(expression(italic("P. vitulina")), 
               expression(italic("P. v. richardii")))
  ) +
  
  #etiquetas
  labs(
    title = "N√∫mero de registros de Phoca vitulina y P. v. richardii por pa√≠s",
    subtitle = "Comparaci√≥n de ocurrencias en Norteam√©rica (GBIF, 2007‚Äì2024)",
    x = "Paises",
    y = "N√∫mero de registros",
    fill = "Especie",
    caption = "Elaborado por Equipo 4  | Datos: GBIF.org"
  ) +
  #theme
  theme_minimal(base_family = "lato") +
  theme(
    plot.title = element_text(size = 16, face = "bold", hjust = 0.5),
    plot.subtitle = element_text(size = 11, hjust = 0.5, color = "gray40"),
    plot.caption = element_text(size = 9, hjust = 0.5, color = "gray60"),
    axis.text.y = element_text(size = 10, color = "gray25"),
    axis.title.y = element_text(size = 12, face = "bold", margin = margin(r = 10)),
    legend.title = element_text(face = "bold"),
    legend.position = "top",
    panel.grid.major.x = element_blank(),
    panel.grid.minor = element_blank(),
    plot.background = element_rect(fill = "white", color = NA)
  ) +
  expand_limits(y = max(focas_resumen$n_obs) * 1.15) #aumenta el limite de y multiplicando el valor maximo por 1.15 para que la visualizaci√≥n sea m√°s agradable

#mostrar gr√°fico
g_abundancias_pais

#guardar gr√°fico de abundancias
ggsave("g_abundancias_pais.png", 
       g_abundancias_pais, width = 10, height = 8, units = "in",
       bg="white",
       dpi = 300)
```

## **Gr√°fico de exploraci√≥n 2:**

```{r message=FALSE, warning=FALSE}
boxplot_clima <- ggplot(
  box_df,
  aes(x = species, y = valor, fill = species)
) +
  #dise√±o de caja y bigotes
  geom_boxplot(
    alpha = 0.8,
    outlier.shape = NA,
    width = 0.6,
    color = "gray20",
    linewidth = 0.4
  ) +
  # dispersi√≥n de puntos
  geom_jitter(
    aes(color = species),
    width = 0.15,
    alpha = 0.4,
  
    size = 1
  ) +
  #facet por variable bioclim√°tica
  facet_wrap(~ variable, scales = "free_y", ncol = 2) +
  #establecer paleta de colores para cajas y puntos
  scale_fill_manual(values = c("#8d62fc", "#fc8d62"), name = "Especie") +
  scale_color_manual(values = c("#26185F", "#682714"), guide = "none") +
  #etiquetas
  labs(
    x = "Especie",
    y = "Valor",
    title = "Comparaci√≥n de condiciones clim√°ticas por especie",
    subtitle = "Variables bioclim√°ticas (WorldClim) extra√≠das en sitios de ocurrencia (GBIF)"
  ) +
  #theme
  theme_minimal(base_size = 12) +
  theme(
    plot.title = element_text(
      size = 16,
      face = "bold",
      hjust = 0.5),
    plot.subtitle = element_text(
      size = 11,
      hjust = 0.5,
      color = "gray30"),
    axis.title.x = element_text(size = 11),
    axis.title.y = element_text(size = 11),
    axis.text.x = element_text(
      angle = 15,
      hjust = 1,
      vjust = 1),
    panel.grid.major.x = element_blank(),
    panel.grid.minor = element_blank(),
    strip.text = element_text(face = "bold", size = 11),
    legend.position = "none", 
    plot.caption = element_text(size = 9, color = "gray40", hjust = 0.5))

#mostrar gr√°fico
print(boxplot_clima)

#guardar gr√°fico
ggsave(
  filename = "g_boxplot_variables_bioclimaticas.png",
  plot = boxplot_clima,
  width = 9,
  height = 6,
  units = "in",
  dpi = 300,
  bg="white"
)
```

# **Gr√°ficos de respuesta**

Para responder a nuestra pregunta de investigaci√≥n optamos por la elaboraci√≥n de mapas de densidad de cada una de las variables clim√°ticas seleccionadas.

## **Gr√°fico de respuesta 1:**

**PASO 1: Elaboraci√≥n de gr√°ficos individuales**

```{r message=FALSE, warning=FALSE}
#grafico temperatura media anual
g_tempm_spp <- ggplot(df_env, aes(x = bio_01, y = species, fill = species)) +
  geom_density_ridges(alpha = 0.8, scale = 1.2, color = "white") +
  scale_fill_manual(values = c("#5F7759", "#CF7940"))+
  labs(
    x = "Temperatura media anual (BIO1)",
    y = "",
    fill = "Especie",
    title = "Distribuci√≥n de la temperatura media anual por especie"
  )+
  scale_x_continuous(limits = c(5, 30), breaks = seq(0, 30, 5))+
  theme_ridges()+
  theme(legend.position = "none")

#gr√°fico estacionalidad de temperatura
g_tempe_spp <- ggplot(df_env, aes(x = bio_04, y = species, fill = species)) +
  geom_density_ridges(alpha = 0.8, scale = 1.2, color = "white", rel_min_height = 0.01) +
  scale_fill_manual(values = c("#5F7759", "#CF7940")) +
  labs(
    x = "Estacionalidad de la temperatura (BIO4)",
    y = "",
    fill = "Especie",
    title = "Distribuci√≥n de estacionalidad de temperatura por especie"
  ) +
  theme_ridges(font_size = 13, grid = TRUE) +
  theme(legend.position = "top")

#gr√°fico precipitaci√≥n anual

g_precipa_spp <- ggplot(df_env, aes(x = bio_12, y = species, fill = species)) +
  geom_density_ridges(alpha = 0.8, scale = 1.2, color = "white") +
  scale_fill_manual(values = c("#5F7759", "#CF7940"))+
  labs(
    x = "Precipitaci√≥n anual (BIO12)",
    y = "",
    fill = "Especie",
    title = "Distribuci√≥n de la precipitaci√≥n anual por especie"
  )+
  theme_ridges()+
  theme(legend.position = "none")

#gr√°fico precipitaci√≥n estacional
g_precipe_spp <- ggplot(df_env, aes(x = bio_15, y = species, fill = species)) +
  geom_density_ridges(alpha = 0.8, scale = 1.2, color = "white") +
  scale_fill_manual(values = c("#5F7759", "#CF7940"))+
  labs(
    x = "Estacionalidad de precipitaci√≥n (BIO15)",
    y = "",
    fill = "Especie",
    title = "Distribuci√≥n de la precipitaci√≥n anual por especie"
  )+
  theme_ridges()+
  theme(legend.position = "none")
```

**PASO 2: Unir gr√°ficos para contrastar variables**

```{r message=FALSE, warning=FALSE}
#gr√°fico de contraste temperatura-precipitaci√≥n anual
g_contraste_tpanual <- (g_tempm_spp + g_precipa_spp)+
  plot_layout(
    design = "
A
B
")
print(g_contraste_tpanual)
#guardar gr√°fico de contraste de temperaturay precipitaci√≥n anual
ggsave("g_contraste_anual.png", 
       g_contraste_tpanual, width = 10, height = 8, units = "in",
       bg="white",
       dpi = 300)

#gr√°fico de contraste estacionalidad temperatura-precipitaci√≥n 
g_contraste_tpestacional <- (g_tempe_spp + g_precipe_spp)+
  plot_layout(
    design = "
A
B
")
print(g_contraste_tpestacional)
#guardar gr√°fico de contraste de estacionalidad de temperatura y precipitaci√≥n 

ggsave("g_contraste_estacional.png", 
       g_contraste_tpestacional, width = 10, height = 8, units = "in",
       bg="white",
       dpi = 300)

```

**PASO 3: unir ambos contrastes**

```{r message=FALSE, warning=FALSE}
g_contraste <- (g_contraste_tpestacional | g_contraste_tpanual)
#mostrar gr√°fico
print(g_contraste)
#guardar gr√°fico de contraste climatico
ggsave("g_contraste_clima.png", 
       g_contraste, width = 10, height = 8, units = "in",
       bg="white",
       dpi = 300)
```

## **Gr√°fico de respuesta 2:**

**PASO 1: Gr√°ficos de gradiente clim√°tico**

```{r message=FALSE, warning=FALSE}
#gr√°fico de gradiente clim√°tico de las especies considerando temperatura y precipitaci√≥n anual
gclimatico_anual<- ggplot(df_env, aes(x = bio_12, y = bio_01, color = species)) +
  #gr√°fico de dispersi√≥n de puntos
  geom_point(alpha = 0.6, size = 2.5) +
  #color de los puntos dado por focas
  scale_color_manual(values = c("#5F7759", "#CF7940"))+
 #theme
   theme_light(base_size = 13) +
  #etiquetas
  labs(
    x = "Precipitaci√≥n anual (mm)",
    y = "Temperatura media anual (¬∞C)",
    color = "Especie",
    title = "Gradiente clim√°tico de las especies"
  )

#gr√°fico de gradiente clim√°tico de las especies considerando estacionalidad de temperatura y precipitaci√≥n 
gclimatico_estacional <- ggplot(df_env, aes(x = bio_15, y = bio_04, color = species)) +
  #gr√°fico de dispersi√≥n de puntos
  geom_point(alpha = 0.6, size = 2.5) +
  #color de los puntos dado por focas
  scale_color_manual(values = c("#5F7759", "#CF7940"))+
 #theme
   theme_light(base_size = 13) +
  #etiquetas
  labs(
    x = "Estacionalidad de Precipitaci√≥n (mm)",
    y = "Estacionalidad de Temperatura (¬∞C)",
    color = "Especie",
    title = "Gradiente clim√°tico de las especies"
  )
```

**PASO 2: A√±adir poligono para delimitar espacio clim√°tico de cada especie**

```{r message=FALSE, warning=FALSE}
#gr√°fico de espacio clim√°tico de las especies considerando temperatura y precipitaci√≥n anual
p_dif_anual_env <- ggplot(df_env, aes(x = bio_12, y = bio_01, color = species, fill = species)) +
  #gr√°fico de distribuci√≥n de puntos
  geom_point(alpha = 0.5, size = 2) +
  #a√±ade poligono del color de cada especie
  stat_ellipse(geom = "polygon", alpha = 0.2, color = NA) +
  scale_color_manual(values = c("#5F7759", "#CF7940"))+
  scale_fill_manual(values = c("#5F7759", "#CF7940"))+
  #theme
  theme_minimal(base_size = 13) +
  #etiquetas
  labs(
    x = "Precipitaci√≥n anual (mm)",
    y = "Temperatura media anual (¬∞C)",
    color = "Especie",
    fill = "Especie",
    title = "Diferencias en el espacio clim√°tico entre especies"
  )
#guardar gr√°fico
ggsave("g_dif_anual.png", 
       p_dif_anual_env, width = 10, height = 8, units = "in",
       bg="white",
       dpi = 300)

#gr√°fico de espacio clim√°tico de las especies considerando estacionalidad de temperatura y precipitaci√≥n 
p_dif_estacional_env <- ggplot(df_env, aes(x = bio_15, y = bio_04, color = species, fill = species)) +
  #gr√°fico de distribuci√≥n de puntos
  geom_point(alpha = 0.5, size = 2) +
  #a√±ade poligono del color de cada especie
  stat_ellipse(geom = "polygon", alpha = 0.2, color = NA) +
  scale_color_manual(values = c("#5F7759", "#CF7940"))+
  scale_fill_manual(values = c("#5F7759", "#CF7940"))+
  #theme
  theme_minimal(base_size = 13) +
  #etiquetas
  labs(
    x = "Estacionalidad de Precipitaci√≥n (mm)",
    y = "Estacionalidad de Temperatura (¬∞C)",
    color = "Especie",
    fill = "Especie",
    title = "Diferencias en el espacio clim√°tico entre especies"
  )
#guardar gr√°fico
ggsave("g_dif_estacionalidad.png", 
       p_dif_estacional_env, width = 10, height = 8, units = "in",
       bg="white",
       dpi = 300)
```

**PASO 3: Unir gr√°ficos de espacio clim√°tico**

```{r message=FALSE, warning=FALSE}
g_espacio <- (p_dif_estacional_env | p_dif_anual_env)
#mostrar gr√°fico
print(g_espacio)
#guardar gr√°fico de contraste climatico
ggsave("g_espacio_clima.png", 
       g_espacio, width = 10, height = 8, units = "in",
       bg="white",
       dpi = 300)
```

# **Resultados**

![](mapa1_NorteAmerica.png)

## **Interpretaci√≥n gr√°ficos de exploraci√≥n**

![](g_abundancias_pais.png)

La gr√°fica comparativa sobre el n√∫mero de registros de *Phoca vitulina* y su subespecie *P. v. richardii* entre Canad√°, Estados Unidos y M√©xico revela una clara predominancia de observaciones en los pa√≠ses del norte. Canad√° y Estados Unidos concentran la mayor√≠a de los registros para ambas especies, con *Phoca vitulina* ligeramente m√°s frecuente que *P. v. richardii*. En contraste, M√©xico presenta un n√∫mero significativamente menor de registros, aunque mantiene una proporci√≥n relativamente equilibrada entre ambas especies. Este patr√≥n sugiere que las focas comunes tienen una distribuci√≥n m√°s amplia y documentada en latitudes altas, mientras que su presencia en M√©xico podr√≠a estar limitada por factores ecol√≥gicos, clim√°ticos o de esfuerzo de muestreo. Estos datos son clave para entender la distribuci√≥n geogr√°fica y los posibles l√≠mites ecol√≥gicos de ambas especies en Am√©rica¬†del¬†Norte.

![](g_boxplot_variables_bioclimaticas.png)

Las dos especies de Phoca vitulina muestran diferencias claras en sus condiciones clim√°ticas: P. v. richardii habita zonas m√°s c√°lidas, secas y con lluvias estacionales, mientras que P. v. se asocia a climas fr√≠os, h√∫medos y con mayor variaci√≥n t√©rmica anual. Estas diferencias reflejan adaptaciones ecol√≥gicas distintas y posibles barreras clim√°ticas en su distribuci√≥n.

## **Interpretaci√≥n gr√°ficos de respuesta**

![](g_contraste_clima.png)

El an√°lisis de los nichos clim√°ticos de *Phoca vitulina* y *Phoca vitulina richardii* revela una divergencia ecol√≥gica sustentada en su distribuci√≥n diferencial frente a la temperatura media anual y la precipitaci√≥n. Esta segregaci√≥n sugiere un proceso de diferenciaci√≥n subespec√≠fica, donde la subespecie *richardii* probablemente ocupa un nicho clim√°tico m√°s restringido, lo que define su mayor vulnerabilidad ante escenarios de cambio clim√°tico en comparaci√≥n con la especie de distribuci√≥n m√°s amplia. La validaci√≥n de estos patrones mediante an√°lisis cuantitativos resulta esencial para confirmar esta divergencia y para orientar estrategias de conservaci√≥n espec√≠ficas.

Las diferencias en la distribuci√≥n de estacionalidad de temperatura y precipitaci√≥n entre *Phoca vitulina* y *Phoca vitulina richardii* reflejan una divergencia ecol√≥gica significativa, donde la primera muestra mayor tolerancia a ambientes con variabilidad clim√°tica, mientras que la segunda se asocia con regiones m√°s estables tanto t√©rmicamente como en r√©gimen de lluvias, lo que sugiere adaptaciones diferenciadas a sus respectivos h√°bitats y posibles implicaciones frente al cambio clim√°tico y la conservaci√≥n de sus nichos.

![](g_espacio_clima.png)

La gr√°fica derecha muestra que *Phoca vitulina richardii* tiende a ocupar espacios clim√°ticos con temperaturas medias anuales m√°s altas y precipitaciones m√°s bajas en comparaci√≥n con *Phoca vitulina*, lo que sugiere una diferenciaci√≥n ecol√≥gica en sus preferencias ambientales; esta separaci√≥n en el espacio clim√°tico indica que cada especie ha desarrollado adaptaciones particulares a condiciones t√©rmicas y pluviom√©tricas distintas, posiblemente reflejando procesos evolutivos, hist√≥ricos de distribuci√≥n y sensibilidad diferencial ante cambios clim√°ticos¬†futuros.

La gr√°fica izquierda revela que *Phoca vitulina* y *Phoca vitulina richardii* ocupan espacios clim√°ticos diferenciados en t√©rminos de estacionalidad, donde la primera se asocia con mayores variaciones tanto en temperatura como en precipitaci√≥n, mientras que la segunda se concentra en ambientes m√°s estables; esta separaci√≥n sugiere que cada especie ha desarrollado adaptaciones ecol√≥gicas espec√≠ficas a la variabilidad clim√°tica de sus h√°bitats, lo cual puede influir en su distribuci√≥n geogr√°fica, comportamiento migratorio y vulnerabilidad ante cambios¬†ambientales.

# **Conclusi√≥n**

El an√°lisis conjunto de los registros de *Phoca vitulina* y *Phoca vitulina richardii* en Am√©rica del Norte entre 2007 y 2024 revela patrones espaciales y altitudinales consistentes que reflejan la estrecha relaci√≥n de estas especies con ambientes costeros de baja altitud. Las gr√°ficas de barras muestran una mayor frecuencia de registros en Canad√° y Estados Unidos, con una presencia m√°s limitada pero significativa en M√©xico, lo que sugiere que las regiones mexicanas representan el l√≠mite sur de su distribuci√≥n. Los mapas de distribuci√≥n confirman esta tendencia, destacando concentraciones en zonas litorales del Pac√≠fico, especialmente en Columbia Brit√°nica, Washington y Baja California. Por su parte, la gr√°fica de dispersi√≥n altitudinal indica que los registros m√°s recientes se ubican entre los 20 y 60 metros sobre el nivel del mar, reforzando la afinidad ecol√≥gica por h√°bitats marinos cercanos al litoral.

Estos hallazgos son fundamentales para comprender la ecolog√≠a de ambas especies, identificar √°reas prioritarias de conservaci√≥n y anticipar posibles desplazamientos derivados del cambio clim√°tico. Adem√°s, el uso de herramientas anal√≠ticas como R permite visualizar y sintetizar grandes vol√∫menes de datos de manera reproducible, fortaleciendo la toma de decisiones basada en evidencia cient√≠fica. En conjunto, este enfoque multidimensional contribuye al monitoreo efectivo de mam√≠feros marinos y a la protecci√≥n de ecosistemas costeros vulnerables.

# **Referencias**

-   Beckerman, A. P., Childs, D. Z., & Petchey, O. L. (2017). Getting started with R: An introduction for biologists (2nd ed.). Oxford University Press.

-   D√≠az Cordero, G. (2012). El cambio clim√°tico. Ciencia y Sociedad, 37(2), 227‚Äì240. Recuperado de <https://www.redalyc.org/articulo.oa?id=87024179004>¬†

-   Morales Luna Hadrys, L. (2014). Inferencias alimentarias de la foca de puerto (Phoca vitulina) en Isla Natividad, Baja California Sur, M√©xico, utilizando como referencia al elefante marino (Mirounga angustirostris) [Tesis de licenciatura, Universidad Aut√≥noma de Baja California Sur]. <https://biblio.uabcs.mx/tesis/te3210.pdf>

-   Nuche Pascual, M. T. (2012). Distribuci√≥n de Phoca vitulina richardsi en las Islas al Occidente de la Pen√≠nsula de Baja California: su relaci√≥n con las surgencias y los bosques de macroalgas [Tesis de maestr√≠a, CICESE]. <https://cicese.repositorioinstitucional.mx/jspui/bitstream/1007/1505/1/189171.pdf>
